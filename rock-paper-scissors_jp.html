<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>じゃんけん</title>
    <link rel="stylesheet" href="style.css">
    <script src="index_jp.js" defer></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
    <div class="background">
    <div class="hero">
        <div class="header">
            <div class="header-links">
                <a class="a-header prevent-select" href="./index_jp.html">ホーム</a>
                <a class="a-header prevent-select" href="./about_jp.html">ストーリー</a>
                <a class="a-header prevent-select" href="./index_jp.html#img-panel">製作物</a>
                <div class="dropbtn prevent-select" onclick="dropdownToggle()">その他<span class="material-icons inline-material-icons prevent-select">expand_more</span>
                    <div class="dropdown-content" id="myDropdown">
                        <a class="prevent-select" href="https://github.com/Swarmz/project-landing-page" target="_blank">GitHub <span class="material-icons inline-material-icons">open_in_new</span></a>
                        <a class="prevent-select" href="https://www.theodinproject.com/about" target="_blank">The Odin Project <span class="material-icons inline-material-icons">open_in_new</span></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="body-container">
    <div class="rps-main">
        <h1 class="rps-title">じゃんけん</h1>
        <div class="rps-container">
            <div id="results">&darr; クリックして開始 &darr;</div>
            <div class="rps-button-container">
                <button class="rpsSelection" type="button" id="rock">
                    <img class="rps-icons" src="./img/rock.png" alt="rock">
                </button>
                <button class="rpsSelection" type="button" id="paper">
                    <img class="rps-icons" src="./img/paper.png" alt="paper">
                </button>
                <button class="rpsSelection" type="button" id="scissors">
                    <img class="rps-icons" src="./img/scissors.png" alt="paper">
                </button>
            </div>
            
            <div class="scoreNames">
                <p id="playerName">YOU</p>
                <p id="computerName">COMPUTER</p>
            </div>
            <div class="scorePoints">
                <p id="playerScore">0</p>
                <p id="computerScore">0</p>
            </div>
        </div>
    </div>
</div>
<div class="footer">
    ギャビン・サットン作<br>
    画像はfreepik.comより提供
    <div class="language-select-box">
        <div>Select Language</div>
        <div class="language-options">
            <a href="./rock-paper-scissors.html">English</a>
        </select>
        </div>
    </div>
</div>
</div>            
    <script>

        function getComputerChoice() {  // get random choice of RPS for computer
            const rockPaperScissors = ["rock", "paper", "scissors"];
            const random = rockPaperScissors[Math.floor(Math.random() * rockPaperScissors.length)]; // random select of rock, paper or scissors from rockPaperScissors array
            return random;
        }

        let playerWins = 0;
        let computerWins = 0;

        function getScore() {
            document.getElementById("computerScore").textContent = computerWins;
            document.getElementById("playerScore").textContent = playerWins;
        }
        
        function playRound(playerSelection) {    // generates player choice via prompt vs random comp choice to determine winner
            const computerSelection = getComputerChoice();  // get random comp choice
                if (playerSelection === "rock") {  
                    if (computerSelection === "paper") {
                        document.getElementById("results").textContent = "負け";
                        return computerWins += 1, getScore(); 
                    }
                    else if (computerSelection === "scissors") {
                        document.getElementById("results").textContent = "勝ち";
                        return playerWins += 1, getScore();
                    }
                    else {
                        document.getElementById("results").textContent = "あいこ";
                    }
                }
                else if (playerSelection === "paper") {
                    if (computerSelection === "scissors") {
                        document.getElementById("results").textContent = "負け";
                        return computerWins += 1, getScore();
                    }
                    else if (computerSelection === "rock") {
                        document.getElementById("results").textContent = "勝ち";
                        return playerWins += 1, getScore();
                    }
                    else {
                        document.getElementById("results").textContent = "あいこ";
                    }
                }
                else if (playerSelection === "scissors") {
                    if (computerSelection === "rock") {
                        document.getElementById("results").textContent = "負け";
                        return computerWins += 1, getScore();
                        
                    }
                    else if (computerSelection === "paper") {
                        document.getElementById("results").textContent = "勝ち";
                        return playerWins += 1, getScore();
                    }
                    else {
                        document.getElementById("results").textContent = "あいこ";
                    }
                }
                else {
                    document.getElementById("results").textContent = "エラー。もう一回してください。";
                }
            }
        
        function winner() {
            if (playerWins > computerWins) {
                document.getElementById("results").textContent =  playerWins +
                    "対" + computerWins + "で勝ちました！";
            } else {
                document.getElementById("results").textContent = computerWins +
                    "対" + playerWins + "で負けてしまいました！";
            }
            document.getElementById('rock').classList.add('disable-button');
            document.getElementById('paper').classList.add('disable-button');
            document.getElementById('scissors').classList.add('disable-button');
            setTimeout(scoreReset, 5000);
        }
        
        function scoreReset() {
            playerWins = 0;
            computerWins = 0;
            document.getElementById("computerScore").textContent = computerWins;
            document.getElementById("playerScore").textContent = playerWins;
            document.getElementById("results").textContent = "Play again!"
            document.getElementById('rock').classList.add('enable-button');
            document.getElementById('paper').classList.add('enable-button');
            document.getElementById('scissors').classList.add('enable-button');
        }

        // to do
        // function replay() {
        //      display pop up
        //      if (retryButton = true) {
        //          close pop up
        //          id="results">&darr; Click to Play! &darr;
        //          playerWins = 0;
        //          computerWins = 0;
            


        //     }
        // }

        document.getElementById("rock").addEventListener("click", function(){ playRound("rock"); if(playerWins === 5 || computerWins === 5) {winner();} });
        document.getElementById("paper").addEventListener("click", function(){ playRound("paper"); if(playerWins === 5 || computerWins === 5) {winner();}  });
        document.getElementById("scissors").addEventListener("click", function(){ playRound("scissors"); if(playerWins === 5 || computerWins === 5) {winner();}  });

    </script>

</body>
    
</html>